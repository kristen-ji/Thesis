GpuFreq=control_disabled
GpuFreq=control_disabled
Traceback (most recent call last):
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/bin/ray", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/scripts/scripts.py", line 2759, in main
    return cli()
           ^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/click/core.py", line 1462, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/click/core.py", line 1383, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/click/core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/click/core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/click/core.py", line 814, in invoke
    return callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/autoscaler/_private/cli_logger.py", line 823, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/scripts/scripts.py", line 939, in start
    node = ray._private.node.Node(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/_private/node.py", line 336, in __init__
    self.start_ray_processes()
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/_private/node.py", line 1397, in start_ray_processes
    resource_and_label_spec = self.get_resource_and_label_spec()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/_private/node.py", line 531, in get_resource_and_label_spec
    ).resolve(is_head=self.head, node_ip_address=self.node_ip_address)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/_private/resource_and_label_spec.py", line 148, in resolve
    self._resolve_accelerator_resources(accelerator_manager, num_accelerators)
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/_private/resource_and_label_spec.py", line 363, in _resolve_accelerator_resources
    accelerator_type = accelerator_manager.get_current_node_accelerator_type()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/_private/accelerators/nvidia_gpu.py", line 68, in get_current_node_accelerator_type
    handle = pynvml.nvmlDeviceGetHandleByIndex(0)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/_private/thirdparty/pynvml/pynvml.py", line 1655, in nvmlDeviceGetHandleByIndex
    _nvmlCheckReturn(ret)
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/ray/_private/thirdparty/pynvml/pynvml.py", line 765, in _nvmlCheckReturn
    raise NVMLError(ret)
ray._private.thirdparty.pynvml.pynvml.NVMLError_Unknown: Unknown Error
srun: error: hkn0603: task 0: Exited with exit code 1
Usage: ray status [OPTIONS]
Try 'ray status --help' for help.

Error: No such option: --redis-password
+ MODEL_PATH=Qwen/Qwen2.5-VL-7B-Instruct
+ python3 -m verl.trainer.main config=examples/config.yaml data.train_files=/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/ThinkLite/output_files/combined_mcts_qwen.parquet data.val_files=/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/ThinkLite/output_files/combined_mcts_qwen.parquet worker.actor.model.model_path=Qwen/Qwen2.5-VL-7B-Instruct trainer.experiment_name=qwen2_5_vl_7b_geo_grpo trainer.n_gpus_per_node=4
/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/torch/cuda/__init__.py:182: UserWarning: CUDA initialization: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero. (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/verl/trainer/main.py", line 22, in <module>
    from ..workers.fsdp_workers import FSDPWorker
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/verl/workers/fsdp_workers.py", line 58, in <module>
    from .config import ActorConfig, CriticConfig, FSDPConfig, ModelConfig, OptimConfig, WorkerConfig
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/verl/workers/config.py", line 23, in <module>
    from .rollout import RolloutConfig
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/verl/workers/rollout/__init__.py", line 17, in <module>
    from .vllm_rollout_spmd import vLLMRollout
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/verl/workers/rollout/vllm_rollout_spmd.py", line 24, in <module>
    from vllm import LLM, RequestOutput, SamplingParams
  File "<frozen importlib._bootstrap>", line 1229, in _handle_fromlist
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/__init__.py", line 68, in __getattr__
    module = import_module(module_name, __package__)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/entrypoints/llm.py", line 17, in <module>
    from vllm.config import (CompilationConfig, ModelDType,
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/config/__init__.py", line 34, in <module>
    from vllm.config.lora import LoRAConfig
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/config/lora.py", line 14, in <module>
    from vllm.platforms import current_platform
  File "<frozen importlib._bootstrap>", line 1229, in _handle_fromlist
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/platforms/__init__.py", line 248, in __getattr__
    _current_platform = resolve_obj_by_qualname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/utils/__init__.py", line 2680, in resolve_obj_by_qualname
    module = importlib.import_module(module_name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/platforms/cuda.py", line 668, in <module>
    CudaPlatform.log_warnings()
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/platforms/cuda.py", line 46, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/platforms/cuda.py", line 614, in log_warnings
    device_names = [
                   ^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/platforms/cuda.py", line 615, in <listcomp>
    cls._get_physical_device_name(i) for i in range(device_ids)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/platforms/cuda.py", line 606, in _get_physical_device_name
    handle = pynvml.nvmlDeviceGetHandleByIndex(device_id)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/third_party/pynvml.py", line 2609, in nvmlDeviceGetHandleByIndex
    _nvmlCheckReturn(ret)
  File "/hkfs/home/project/hk-project-pai00012/st_st190232/use-ray-with-slurm/EasyR1-New/EasyR1/.venv/lib64/python3.11/site-packages/vllm/third_party/pynvml.py", line 1047, in _nvmlCheckReturn
    raise NVMLError(ret)
vllm.third_party.pynvml.NVMLError_Unknown: Unknown Error
