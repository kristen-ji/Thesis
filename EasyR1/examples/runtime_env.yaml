working_dir: ./
excludes: ["/.git/"]
env_vars:
  TOKENIZERS_PARALLELISM: "true"
  NCCL_DEBUG: "WARN"
  VLLM_LOGGING_LEVEL: "WARN"
  TORCH_NCCL_AVOID_RECORD_STREAMS: "1"
  PYTORCH_CUDA_ALLOC_CONF: "expandable_segments:False"
  CUDA_DEVICE_MAX_CONNECTIONS: "1"
  VLLM_ALLREDUCE_USE_SYMM_MEM: "0"
  RAY_verbose_spill_logs: "1"
  RAY_LOG_TO_STDERR: "1"
  RAY_BACKEND_LOG_LEVEL: "debug"
  # Enable object spilling to disk under workspace to reduce shmem pressure
  RAY_object_spilling_config: '{"type":"filesystem","params":{"directory_path":"/hkfs/work/workspace/scratch/st_st190232-myspace/ray_spill"}}'
  # Redirect large temps/spill to workspace to avoid /tmp and /dev/shm pressure
  RAY_TMPDIR: "/hkfs/work/workspace/scratch/st_st190232-myspace/ray_tmp"
  RAY_memstore_allow_fallback_to_memory: "0"
  # Torch shared memory strategy to file system reduces /dev/shm usage
  TORCH_SHARE_STRATEGY: "file_system"
